#!/usr/bin/env ruby

require 'minitest/autorun'

class SeparateALternativesTest < Minitest::Test
  def test_separate
    expected = "1\t19878451\t19878451\tG\tA\tAC=5;AN=9004\n1\t19878618\t19878618\tC\tT\tAC=11;AN=7104\n1\t19878618\t19878618\tC\tA\tAC=23;AN=7104\n1\t26815020\t26815020\tG\tC\tAC=800;AN=6990\n1\t26815020\t26815020\tG\tA\tAC=1194;AN=6990\n1\t26815020\t26815020\tG\tT\tAC=1;AN=6990\n1\t19878451\t19878451\tG\tA\tAF=0.0007\n1\t19878618\t19878618\tC\tT\tAF=0.0011\n1\t19878618\t19878618\tC\tA\tAF=0.0005\n1\t26815020\t26815020\tG\tC\tAF=0.1111\n1\t26815020\t26815020\tG\tA\tAF=0.1765\n1\t26815020\t26815020\tG\tT\tAF=0.0111\n"
    parsed   = `ruby tommo_separate_alternatives.rb 91_t_dir/tommo.test_data.180625.txt`

    puts "Input data"
    puts `cat 91_t_dir/tommo.test_data.180625.txt`

    puts "Parsed data"
    puts parsed

    assert_equal parsed, expected
  end

  def test_maf_separate
    expected = "22\t51234020\t51234020\tA\tT\tAF=0.0003\n22\t51234020\t51234020\tA\tG\tAF=0.0001\n22\t51234752\t51234752\tC\tA\tAF=0.0008\n22\t51234752\t51234752\tC\tG\tAF=0.0001\n22\t51238394\t51238394\tC\tG\tAF=0.0013\n22\t51238394\t51238394\tC\tT\tAF=0.0008\nX\t155259223\t155259223\tC\tT\tAF=0.0057\nX\t155259223\t155259223\tC\tG\tAF=0.0001\nX\t155259551\t155259551\tC\tG\tAF=0.0032\nX\t155259551\t155259551\tC\tT\tAF=0.0001\nX\t155259585\t155259585\tC\tG\tAF=0.3725\nX\t155259585\t155259585\tC\tA\tAF=0.0329\nX\t155259626\t155259626\tT\tA\tAF=0.1332\nX\t155259626\t155259626\tT\tG\tAF=0.0084\nMT\t66\t66\tG\tA\tAF=0.0014\nMT\t66\t66\tG\tT\tAF=0.0003\nMT\t73\t73\tA\tG\tAF=0.9935\nMT\t73\t73\tA\tC\tAF=0.0059\nMT\t186\t186\tC\tT\tAF=0.0011\nMT\t186\t186\tC\tA\tAF=0.0003\nMT\t195\t195\tT\tC\tAF=0.0442\nMT\t195\t195\tT\tA\tAF=0.0006\nMT\t235\t235\tA\tG\tAF=0.0729\nMT\t235\t235\tA\tT\tAF=0.0003\nMT\t466\t466\tT\tC\tAF=0.0006\nMT\t466\t466\tT\tG\tAF=0.0006\nMT\t723\t723\tA\tC\tAF=0.0006\nMT\t723\t723\tA\tG\tAF=0.0003\nMT\t1692\t1692\tA\tC\tAF=0.0023\nMT\t1692\t1692\tA\tG\tAF=0.0003\nMT\t1900\t1900\tA\tT\tAF=0.0006\nMT\t1900\t1900\tA\tG\tAF=0.0006\nMT\t2109\t2109\tA\tG\tAF=0.0014\nMT\t2109\t2109\tA\tT\tAF=0.0011\nMT\t2772\t2772\tC\tT\tAF=0.0721\nMT\t2772\t2772\tC\tA\tAF=0.0003\nMT\t13928\t13928\tG\tC\tAF=0.0681\nMT\t13928\t13928\tG\tT\tAF=0.0017\nMT\t13928\t13928\tG\tA\tAF=0.0014\nMT\t16265\t16265\tA\tC\tAF=0.0037\nMT\t16265\t16265\tA\tG\tAF=0.0011\nMT\t16265\t16265\tA\tT\tAF=0.0003\n"
    parsed   = `ruby tommo_separate_alternatives.rb 91_t_dir/tommo.test_data.180709.MAF.txt`

    puts "Input data"
    puts `cat 91_t_dir/tommo.test_data.180709.MAF.txt`

    puts "Parsed data"
    puts parsed

    assert_equal parsed, expected
  end

  def test_info_separate
    expected = "22\t51234020\t51234020\tA\tT\tAC=2;AN=7104\n22\t51234020\t51234020\tA\tG\tAC=1;AN=7104\n22\t51234752\t51234752\tC\tA\tAC=6;AN=7094\n22\t51234752\t51234752\tC\tG\tAC=1;AN=7094\n22\t51238394\t51238394\tC\tG\tAC=9;AN=7104\n22\t51238394\t51238394\tC\tT\tAC=6;AN=7104\nX\t155259223\t155259223\tC\tT\tAC_MALE=18;AN_MALE=3072; AC_FEMALE=22;AN_FEMALE=3978\nX\t155259223\t155259223\tC\tG\tAC_MALE=1;AN_MALE=3072; AC_FEMALE=0;AN_FEMALE=3978\nX\t155259551\t155259551\tC\tG\tAC_MALE=7;AN_MALE=3006; AC_FEMALE=15;AN_FEMALE=3886\nX\t155259551\t155259551\tC\tT\tAC_MALE=0;AN_MALE=3006; AC_FEMALE=1;AN_FEMALE=3886\nX\t155259585\t155259585\tC\tG\tAC_MALE=211;AN_MALE=552; AC_FEMALE=321;AN_FEMALE=876\nX\t155259585\t155259585\tC\tA\tAC_MALE=17;AN_MALE=552; AC_FEMALE=30;AN_FEMALE=876\nX\t155259626\t155259626\tT\tA\tAC_MALE=61;AN_MALE=544; AC_FEMALE=114;AN_FEMALE=770\nX\t155259626\t155259626\tT\tG\tAC_MALE=10;AN_MALE=544; AC_FEMALE=1;AN_FEMALE=770\nMT\t66\t66\tG\tA\tAC_MALE=2;AN_MALE=1546; AC_FEMALE=3;AN_FEMALE=2003\nMT\t66\t66\tG\tT\tAC_MALE=1;AN_MALE=1546; AC_FEMALE=0;AN_FEMALE=2003\nMT\t73\t73\tA\tG\tAC_MALE=1537;AN_MALE=1547; AC_FEMALE=1992;AN_FEMALE=2005\nMT\t73\t73\tA\tC\tAC_MALE=8;AN_MALE=1547; AC_FEMALE=13;AN_FEMALE=2005\nMT\t186\t186\tC\tT\tAC_MALE=3;AN_MALE=1545; AC_FEMALE=1;AN_FEMALE=2002\nMT\t186\t186\tC\tA\tAC_MALE=0;AN_MALE=1545; AC_FEMALE=1;AN_FEMALE=2002\nMT\t195\t195\tT\tC\tAC_MALE=67;AN_MALE=1547; AC_FEMALE=90;AN_FEMALE=2005\nMT\t195\t195\tT\tA\tAC_MALE=2;AN_MALE=1547; AC_FEMALE=0;AN_FEMALE=2005\nMT\t235\t235\tA\tG\tAC_MALE=112;AN_MALE=1547; AC_FEMALE=147;AN_FEMALE=2005\nMT\t235\t235\tA\tT\tAC_MALE=0;AN_MALE=1547; AC_FEMALE=1;AN_FEMALE=2005\nMT\t466\t466\tT\tC\tAC_MALE=1;AN_MALE=1547; AC_FEMALE=1;AN_FEMALE=2005\nMT\t466\t466\tT\tG\tAC_MALE=1;AN_MALE=1547; AC_FEMALE=1;AN_FEMALE=2005\nMT\t723\t723\tA\tC\tAC_MALE=0;AN_MALE=1547; AC_FEMALE=2;AN_FEMALE=2005\nMT\t723\t723\tA\tG\tAC_MALE=0;AN_MALE=1547; AC_FEMALE=1;AN_FEMALE=2005\nMT\t1692\t1692\tA\tC\tAC_MALE=3;AN_MALE=1547; AC_FEMALE=5;AN_FEMALE=2005\nMT\t1692\t1692\tA\tG\tAC_MALE=0;AN_MALE=1547; AC_FEMALE=1;AN_FEMALE=2005\nMT\t1900\t1900\tA\tT\tAC_MALE=0;AN_MALE=1547; AC_FEMALE=2;AN_FEMALE=2005\nMT\t1900\t1900\tA\tG\tAC_MALE=0;AN_MALE=1547; AC_FEMALE=2;AN_FEMALE=2005\nMT\t2109\t2109\tA\tG\tAC_MALE=3;AN_MALE=1547; AC_FEMALE=2;AN_FEMALE=2005\nMT\t2109\t2109\tA\tT\tAC_MALE=1;AN_MALE=1547; AC_FEMALE=3;AN_FEMALE=2005\nMT\t2772\t2772\tC\tT\tAC_MALE=118;AN_MALE=1547; AC_FEMALE=138;AN_FEMALE=2005\nMT\t2772\t2772\tC\tA\tAC_MALE=1;AN_MALE=1547; AC_FEMALE=0;AN_FEMALE=2005\nMT\t13928\t13928\tG\tC\tAC_MALE=121;AN_MALE=1547; AC_FEMALE=121;AN_FEMALE=2005\nMT\t13928\t13928\tG\tT\tAC_MALE=1;AN_MALE=1547; AC_FEMALE=5;AN_FEMALE=2005\nMT\t13928\t13928\tG\tA\tAC_MALE=0;AN_MALE=1547; AC_FEMALE=5;AN_FEMALE=2005\nMT\t16265\t16265\tA\tC\tAC_MALE=6;AN_MALE=1547; AC_FEMALE=7;AN_FEMALE=2005\nMT\t16265\t16265\tA\tG\tAC_MALE=2;AN_MALE=1547; AC_FEMALE=2;AN_FEMALE=2005\nMT\t16265\t16265\tA\tT\tAC_MALE=0;AN_MALE=1547; AC_FEMALE=1;AN_FEMALE=2005\n"
    parsed   = `ruby tommo_separate_alternatives.rb 91_t_dir/tommo.test_data.180709.INFO.txt`

    puts "Input data"
    puts `cat 91_t_dir/tommo.test_data.180709.INFO.txt`

    puts "Parsed data"
    puts parsed

    assert_equal parsed, expected
 end
end
